
      Introducing


  Socket.IO <./>

v.9 <http://github.com/learnboost/socket.io/>

Google Groups <http://groups.google.com/group/socket_io>
Email:

Home <#home> How to use <#how-to-use> Browser Support <#browser-support>
FAQ <#faq> Wiki <http://github.com/learnboost/socket.io/wiki/>


    What is Socket.IO?

*Socket.IO* aims to make realtime apps possible in every browser and
mobile device, blurring the differences between the different transport
mechanisms. It's care-free realtime 100% in JavaScript.


        Server

var io = require('socket.io').listen(80);

io.sockets.on('connection', function (socket) {
  socket.emit('news', { hello: 'world' });
  socket.on('my other event', function (data) {
    console.log(data);
  });
});


        Client

<script src="/socket.io/socket.io.js"></script>
<script>
  var socket = io.connect('http://localhost');
  socket.on('news', function (data) {
    console.log(data);
    socket.emit('my other event', { my: 'data' });
  });
</script>


    How to use


      Installing

npm install socket.io


      Using with Node HTTP server

For this example, simply run `npm install socket.io`


        Server (app.js)

var app = require('http').createServer(handler)
  , io = require('socket.io').listen(app)
  , fs = require('fs')

app.listen(80);

function handler (req, res) {
  fs.readFile(__dirname + '/index.html',
  function (err, data) {
    if (err) {
      res.writeHead(500);
      return res.end('Error loading index.html');
    }

    res.writeHead(200);
    res.end(data);
  });
}

io.sockets.on('connection', function (socket) {
  socket.emit('news', { hello: 'world' });
  socket.on('my other event', function (data) {
    console.log(data);
  });
});


        Client (index.html)

<script src="/socket.io/socket.io.js"></script>
<script>
  var socket = io.connect('http://localhost');
  socket.on('news', function (data) {
    console.log(data);
    socket.emit('my other event', { my: 'data' });
  });
</script>


      Using with the Express 3 web framework

Express 3 requires that you instantiate a `http.Server` to attach
socket.io to first:


        Server (app.js)

var app = require('express')()
  , server = require('http').createServer(app)
  , io = require('socket.io').listen(server);

server.listen(80);

app.get('/', function (req, res) {
  res.sendfile(__dirname + '/index.html');
});

io.sockets.on('connection', function (socket) {
  socket.emit('news', { hello: 'world' });
  socket.on('my other event', function (data) {
    console.log(data);
  });
});


        Client (index.html)

<script src="/socket.io/socket.io.js"></script>
<script>
  var socket = io.connect('http://localhost');
  socket.on('news', function (data) {
    console.log(data);
    socket.emit('my other event', { my: 'data' });
  });
</script>


      Using with the Express web framework

You can serve normal pages and AJAX requests with Express, and attach
your socket.io server

For this example, simply run `npm install socket.io express`


        Server (app.js)

var app = require('express').createServer()
  , io = require('socket.io').listen(app);

app.listen(80);

app.get('/', function (req, res) {
  res.sendfile(__dirname + '/index.html');
});

io.sockets.on('connection', function (socket) {
  socket.emit('news', { hello: 'world' });
  socket.on('my other event', function (data) {
    console.log(data);
  });
});


        Client (index.html)

<script src="/socket.io/socket.io.js"></script>
<script>
  var socket = io.connect('http://localhost');
  socket.on('news', function (data) {
    console.log(data);
    socket.emit('my other event', { my: 'data' });
  });
</script>


      Sending and receiving events.

Socket.IO allows you to emit and receive custom events. Besides
`connect`, `message` and `disconnect`, you can emit custom events:


        Server

// note, io.listen(<port>) will create a http server for you
var io = require('socket.io').listen(80);

io.sockets.on('connection', function (socket) {
  io.sockets.emit('this', { will: 'be received by everyone'});

  socket.on('private message', function (from, msg) {
    console.log('I received a private message by ', from, ' saying ', msg);
  });

  socket.on('disconnect', function () {
    io.sockets.emit('user disconnected');
  });
});


      Storing data associated to a client

Sometimes it's necessary to store data associated with a client that's
necessary for the duration of the session.


        Server

var io = require('socket.io').listen(80);

io.sockets.on('connection', function (socket) {
  socket.on('set nickname', function (name) {
    socket.set('nickname', name, function () {
      socket.emit('ready');
    });
  });

  socket.on('msg', function () {
    socket.get('nickname', function (err, name) {
      console.log('Chat message by ', name);
    });
  });
});


        Client

<script src="/socket.io/socket.io.js"></script>
<script>
  var socket = io.connect('http://localhost');
  socket.on('news', function (data) {
    console.log(data);
    socket.emit('my other event', { my: 'data' });
  });
</script>


      Restricting yourself to a namespace.

If you have control over all the messages and events emitted for a
particular application, using the default / namespace works. If you want
to leverage 3rd-party code, or produce code to share with others,
socket.io provides a way of namespacing a socket.

This has the benefit of `multiplexing` a single connection. Instead of
socket.io using two `WebSocket` connections, it'll use one.


        Server

var io = require('socket.io').listen(80);

var chat = io
  .of('/chat')
  .on('connection', function (socket) {
    socket.emit('a message', {
        that: 'only'
      , '/chat': 'will get'
    });
    chat.emit('a message', {
        everyone: 'in'
      , '/chat': 'will get'
    });
  });

var news = io
  .of('/news')
  .on('connection', function (socket) {
    socket.emit('item', { news: 'item' });
  });


        Client

<script>
  var chat = io.connect('http://localhost/chat')
    , news = io.connect('http://localhost/news');
  
  chat.on('connect', function () {
    chat.emit('hi!');
  });
  
  news.on('news', function () {
    news.emit('woot');
  });
</script>


      Sending volatile messages.

Sometimes certain messages can be dropped. Let's say you have an app
that shows realtime tweets for the keyword `bieber`.

If a certain client is not ready to receive messages (because of network
slowness or other issues, or because he's connected through long polling
and is in the middle of a request-response cycle), if he doesn't receive
ALL the tweets related to bieber your application won't suffer.

In that case, you might want to send those messages as volatile messages.


        Server

var io = require('socket.io').listen(80);

io.sockets.on('connection', function (socket) {
  var tweets = setInterval(function () {
    getBieberTweet(function (tweet) {
      socket.volatile.emit('bieber tweet', tweet);
    });
  }, 100);

  socket.on('disconnect', function () {
    clearInterval(tweets);
  });
});


      Sending and getting data (acknowledgements).

Sometimes, you might want to get a callback when the client confirmed
the message reception.

To do this, simply pass a function as the last parameter of `.send` or
`.emit`. What's more, when you use `.emit`, the acknowledgement is done
by you, which means you can also pass data along:


        Server

var io = require('socket.io').listen(80);

io.sockets.on('connection', function (socket) {
  socket.on('ferret', function (name, fn) {
    fn('woot');
  });
});


        Client

<script>
  var socket = io.connect(); // TIP: .connect with no args does auto-discovery
  socket.on('connect', function () { // TIP: you can avoid listening on `connect` and listen on events directly too!
    socket.emit('ferret', 'tobi', function (data) {
      console.log(data); // data will be 'woot'
    });
  });
</script>


      Broadcasting messages.

To broadcast, simply add a `broadcast` flag to `emit` and `send` method
calls. Broadcasting means sending a message to everyone else except for
the socket that starts it.


        Server

var io = require('socket.io').listen(80);

io.sockets.on('connection', function (socket) {
  socket.broadcast.emit('user connected');
});


      Using it just as a cross-browser WebSocket.

If you just want the WebSocket semantics, you can do that too. Simply
leverage `send` and listen on the `message` event:


        Server

var io = require('socket.io').listen(80);

io.sockets.on('connection', function (socket) {
  socket.on('message', function () { });
  socket.on('disconnect', function () { });
});


        Client

<script>
  var socket = io.connect('http://localhost/');
  socket.on('connect', function () {
    socket.send('hi');

    socket.on('message', function (msg) {
      // my msg
    });
  });
</script>


    Supported transports

In order to provide realtime connectivity on every browser, Socket.IO
selects the most capable transport at runtime, without it affecting the
API.

  * WebSocket
  * Adobe® Flash® Socket
  * AJAX long polling
  * AJAX multipart streaming
  * Forever Iframe
  * JSONP Polling


    Supported browsers


      Desktop

  * Internet Explorer 5.5+
  * Safari 3+
  * Google Chrome 4+
  * Firefox 3+
  * Opera 10.61+


      Mobile

  * iPhone Safari
  * iPad Safari
  * Android WebKit
  * WebOs WebKit


    FAQ


      Does Socket.IO support cross-domain connections?

Absolutely, on every browser!


      Why Flash?

Flash is absolutely *not required* for Socket.IO to function. If Flash
is available, it'll be leveraged, as it provides almost the same
capabilities as WebSocket. If it's not, the best next transport will be
chosen.


      I want to host the Socket.IO client myself

If you're not relying on Node.JS serving Socket.IO clientside JavaScript
files, make sure you set the `WEB_SOCKET_SWF_LOCATION` right after
including socket.io.js with the location of the WebSocketMain.swf

This is required in order for Socket.IO to find the .swf file required
for Flash WebSocket.


      Why not just call it `WebSocket` if the actual WebSocket is not
      present and mimick its API?

Socket.IO does more than WebSocket, even if WebSocket is selected as the
transport and the user is browsing your website with an ultra modern
browser. Certain features like heartbeats, timeouts and disconnection
support are vital to realtime applications but are not provided by the
WebSocket API out of the box.

This is akin to jQuery's decision of creating a feature-rich and simple
$.ajax API as opposed to normalizing XMLHttpRequest.

Socket.IO by Guillermo Rauch <http://devthought.com> at gradebook
<http://learnboost.com> LearnBoost Labs <http://github.com/learnboost/>.
Released under the MIT license - Copyright LearnBoost 2012
<http://learnboost.com>

Fork me on GitHub <http://github.com/learnboost/socket.io>
